RewriteEngine On
RewriteBase /

# 1️⃣ منع إعادة كتابة index.html نفسه
RewriteRule ^index\.html$ - [L]

# 2️⃣ إزالة trailing slash من ملفات الـ assets (CSS, JS, images, etc)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} \.(css|js|jpg|jpeg|png|gif|svg|ico|woff|woff2|ttf|eot|json|xml)$ [NC]
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [R=301,L]

# 3️⃣ فرض trailing slash على الصفحات فقط (عشان إنستجرام) - لكن ليس على الملفات
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !\.(css|js|jpg|jpeg|png|gif|svg|ico|woff|woff2|ttf|eot|json|xml)$ [NC]
RewriteCond %{REQUEST_URI} !/$
RewriteRule ^(.*)$ https://goldenphoenixtravel.com/$1/ [L,R=301]

# 4️⃣ React SPA fallback
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

# Cache static assets
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>
